<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/admin.css">
    <title>Team Control | Croevo AI</title>
</head>
<body>

<nav class="sidebar">
    <h3 class="gradient-text">CROEVO ADMIN</h3>
    <ul class="nav-menu">
        <li><a href="dashboard.html">Overview</a></li>
        <li><a href="memo-gen.html">Memo Generator</a></li>
        <li><a href="news-post.html">Announcements</a></li>
        <li><a href="team-manage.html" class="active">Team Control</a></li>
        <li><a href="subscribers.html">Subscribers</a></li>
        <li><a href="settings.html">Settings</a></li>
    </ul>
</nav>

<div class="main-content">
    <h2 class="gradient-text">ðŸ‘¥ Team Management</h2>
    
    <div style="display: grid; grid-template-columns: 1fr 1.5fr; gap: 30px;">
        <div class="admin-card">
            <h3 style="margin-bottom: 20px;">Add New Member</h3>
            <label>Full Name</label>
            <input type="text" id="memberName" class="admin-input" placeholder="e.g. Abhinav">
            
            <label>Role</label>
            <input type="text" id="memberRole" class="admin-input" placeholder="e.g. Founder & Lead Developer">
            
            <label>Profile Image URL</label>
            <input type="text" id="memberImg" class="admin-input" placeholder="https://link-to-image.jpg">
            
            <label>Short Bio</label>
            <textarea id="memberBio" class="admin-input" style="height: 100px;" placeholder="Describe their contribution..."></textarea>
            
            <button id="addMemberBtn" class="btn-primary" style="width: 100%;">Add to Croevo Team</button>
        </div>

        <div class="admin-card">
            <h3 style="margin-bottom: 20px;">Current Staff</h3>
            <div id="currentTeamList">
                <p style="color: #94a3b8;">Fetching team data...</p>
            </div>
        </div>
    </div>
</div>

<script type="module">
    import { supabase } from '../js/supabase-config.js';

    // FUNCTION: Load and display current team
    async function fetchTeam() {
        const { data: members, error } = await supabase
            .from('team')
            .select('*')
            .order('name', { ascending: true });

        if (members) {
            document.getElementById('currentTeamList').innerHTML = members.map(m => `
                <div style="display: flex; align-items: center; justify-content: space-between; padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.05);">
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <div style="width: 40px; height: 40px; border-radius: 8px; background-image: url('${m.image_url || ''}'); background-size: cover; background-color: #1e293b;"></div>
                        <div>
                            <div style="font-weight: bold;">${m.name}</div>
                            <div style="font-size: 0.8rem; color: var(--primary);">${m.role}</div>
                        </div>
                    </div>
                </div>
            `).join('');
        }
    }

    // FUNCTION: Add new member
    document.getElementById('addMemberBtn').onclick = async () => {
        const name = document.getElementById('memberName').value;
        const role = document.getElementById('memberRole').value;
        const image_url = document.getElementById('memberImg').value;
        const bio = document.getElementById('memberBio').value;

        if(!name || !role) return alert("Name and Role are required.");

        const { error } = await supabase.from('team').insert([{ name, role, image_url, bio }]);

        if (error) {
            alert("Error: " + error.message);
        } else {
            alert("Member added successfully!");
            location.reload(); // Refresh to show new member
        }
    };

    // Initial Load
    fetchTeam();
</script>

</body>
</html>